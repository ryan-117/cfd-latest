System.register(["./element-plus-legacy.js","./@vue-legacy.js","./vue-router-legacy.js","./category-legacy.js","./article-legacy.js","./tag-legacy.js","./sys_config-legacy.js","./tinymce-legacy.js","./upload-legacy.js","./index-legacy.js","./dayjs-legacy.js","./ace-builds-legacy.js","./@element-plus-legacy.js","./lodash-es-legacy.js","./@popperjs-legacy.js","./async-validator-legacy.js","./@ctrl-legacy.js","./memoize-one-legacy.js","./normalize-wheel-es-legacy.js","./pinia-legacy.js","./pinia-plugin-persist-legacy.js","./axios-legacy.js","./js-cookie-legacy.js","./nprogress-legacy.js","./saduo-legacy.js"],function(e,l){"use strict";var a,t,u,d,o,s,n,i,r,c,m,p,f,v,g,y,V,b,_,h,w,j,x,k,U,C,I,A,S,D,O,T,z,E,N,R,q,L,B,F,J,P,M,$,G,H,K,Q,W,Z,X,Y,ee,le,ae,te,ue,de,oe,se;return{setters:[e=>{a=e.n,t=e.m,u=e.u,d=e.G,o=e.r,s=e.N,n=e.s,i=e.O,r=e.P,c=e.Q,m=e.R,p=e.S,f=e.T,v=e.a,g=e.U,y=e.f,V=e.o,b=e.C,_=e.I,h=e.L,w=e.M,j=e.B,x=e.D,k=e.q,U=e.E},e=>{C=e.r,I=e.W,A=e.n,S=e.aj,D=e.c,O=e.o,T=e.a,z=e.V,E=e.L,N=e.K,R=e.H,q=e.S,L=e.a3,B=e.I,F=e.ab,J=e.T},e=>{P=e.u,M=e.a},e=>{$=e.f},e=>{G=e.a,H=e.f,K=e.d,Q=e.u},e=>{W=e.s},e=>{Z=e.v},e=>{X=e.t,Y=e._},e=>{ee=e.u},e=>{le=e._,ae=e.d,te=e.a,ue=e.t,de=e.b,oe=e.c,se=e.f},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var l=document.createElement("style");l.textContent="[data-v-f9faf703] .tiny-textarea{height:436px}.cover[data-v-f9faf703]{padding:6px}.cover div[data-v-f9faf703]{width:120px;height:120px;cursor:pointer;margin:5px}.w-300[data-v-f9faf703]{width:300px!important}[data-v-f9faf703] .el-drawer{width:280px!important}[data-v-f9faf703] .el-drawer__body{padding:0}.imgs-btn[data-v-f9faf703]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);color:#fff;font-size:20px;cursor:pointer;justify-content:center;align-items:center;gap:30px;display:none;transition:all .3s}.img-item[data-v-f9faf703]{position:relative;margin-right:10px;cursor:pointer;overflow:hidden;border-radius:5px;border:1px solid #f2f2f2}.img-item:hover .imgs-btn[data-v-f9faf703]{display:flex}.upload-icon[data-v-f9faf703]{border:1px dashed #dcdfe6;border-radius:6px;cursor:pointer;position:relative;overflow:hidden;transition:.2s;font-size:28px;color:#8c939d;width:100px;height:100px;text-align:center}\n/*$vite$:1*/",document.head.appendChild(l);const ne={class:"bg-fff pd-10 radius-6"},ie={class:"mr-10 ml-10"},re={class:"mr-10 ml-10 mb-20"},ce={class:"cover row"},me={key:0,class:"cover flex align-center"},pe={class:"imgs-btn"};e("default",le({__name:"edit",setup(e){const l=P(),le=M(),fe=C({...X}),ve=C(!0),ge=C([]),ye={checkStrictly:!0},Ve=C("first"),be=C("0"),_e=C([]),he=C([]),we=C([]),je=C(!1),xe=C(!1),ke=C(1),Ue=C([]),Ce=C(),Ie=C(),Ae=C(""),Se=I({id:0,cid:0,subCid:[],title:"",shortTitle:"",tagId:"",attr:[],articleView:"",source:"",author:"",description:"",img:"",createdAt:new Date,updatedAt:new Date,content:"",status:"0",pv:1,link:""}),De=C([]),Oe=C({}),Te=C(""),ze=C(!1),Ee=C(1),Ne=C(!1),Re=C(["/public/cover/01.jpg","/public/cover/02.jpg","/public/cover/03.jpg","/public/cover/04.jpg","/public/cover/05.jpg","/public/cover/06.jpg","/public/cover/07.jpg","/public/cover/08.jpg","/public/cover/09.jpg","/public/cover/10.jpg"]),qe=()=>{ve.value=!1},Le=e=>{be.value=e.index},Be=async(e="")=>{try{let l=await W(Ee.value,e,100);200===l.code&&(Ue.value=l.data.list.map(e=>({label:e.name,value:e.id})))}catch(l){console.log(l)}},Fe=e=>{-1!=e[0]?(Se.cid=e[e.length-1],Je(Se.cid)):De.value=[]},Je=async e=>{try{let l=await H(e);200===l.code&&(l.data.fields.forEach(e=>{if(e.defaultVal&&e.defaultVal.includes("[{")&&e.defaultVal.includes("options")){let l=JSON.parse(e.defaultVal);e.defaultVal=l.options||[]}"8"==e.type&&(e.values=[])}),De.value=l.data.fields,De.value.forEach(e=>{Oe?.value?.[e.ename]?.includes("[")?e.values=JSON.parse(Oe.value[e.ename]):e.values=Oe?.value?.[e.ename]}))}catch(l){console.log(l)}},Pe=e=>{console.log("e--\x3e",e)},Me=e=>{if(-1===e.type.indexOf("image"))return U({message:"上传文件只能是图片格式",type:"success"}),!1;Ce.value=e;const l=new FileReader;return l.onload=async e=>{let l;l="object"==typeof e.target.result?window.URL.createObjectURL(new Blob([e.target.result])):e.target.result,Ae.value=l},l.readAsArrayBuffer(e),!0},$e=async()=>{if(Ce.value.size/1024/1024>.2)return U({message:"上传图片必须小于200k",type:"success"}),!1;const e=new FormData;e.append("file",Ce.value);const l=await ee(e,"1");200===l.code&&(Se.img=l.data.path)},Ge=e=>-1===e.type.indexOf("image")?(U({message:"上传文件只能是图片格式",type:"success"}),!1):e.size/1024/1024>.2?(U({message:"上传图片必须小于200k",type:"success"}),!1):void 0,He=async e=>{const{data:{index:l},file:a}=e;let t=new FormData;t.append("file",a);let u=await ee(t,"2");if(200===u.code){const e=u.data.map(e=>({name:e.filename,url:e.path}));Array.isArray(De.value[l].values)?De.value[l].values.push(...e):De.value[l].values=[...e]}},Ke=async e=>{try{await K(e)}catch(l){console.log(l)}},Qe=e=>{e&&e.validate((e,a)=>{if(!e)return de(a),!1;0!==Se.cid?(async()=>{try{let e={...Se};e.attr=e.attr.toString(),e.subCid=e.subCid.toString(),e.tagId=e.tagId.toString(),!e.img&&je.value&&(e.img=oe(e.content)[0]),!e.description&&xe.value&&(e.description=se(e.content).substr(0,255)),De.value.map(e=>{Oe.value[e.ename]="object"==typeof e.values?JSON.stringify(e.values):e.values});let a=await Q({...e,field:Oe.value});200===a.code?(U({message:"更新成功^_^",type:"success"}),l.go(-1)):U({message:a.msg,type:"success"})}catch(e){console.log(e)}})():U({message:"请选择栏目^_^",type:"success"})})};return A(async()=>{Se.id=le.params.id,await(async()=>{try{let e=await G(Se.id);if(200===e.code){let l=e.data;l.attr=l.attr?l.attr.split(","):[],l.subCid=l.subCid?l.subCid.split(",").map(Number):[],l.oldTagId=l.tagId,l.tagId=l.tagId?l.tagId.split(",").map(Number):[],l.status=l.status.toString(),l.updatedAt=new Date(l.createdAt),Object.assign(Se,l),Oe.value=l.field||{},ve.value=!1}}catch(e){console.error(e)}})(),await(async()=>{try{let e=await $();if(200===e.code){let l=e.data,a=ae(Se.cid,l);ge.value=a;let t=te(ue(l));he.value=te(l),_e.value=[...t],Je(Se.cid)}}catch(e){console.log(e)}})(),Be(),(async()=>{try{let e=await Z();200===e.code&&(we.value=e.data.filter(e=>"404.html"!==e&&"500.html"!==e).map(e=>({label:e,value:e})))}catch(e){console.log(e)}})()}),(e,l)=>{const U=a,C=t,I=s,A=o,P=d,M=n,$=i,G=c,H=r,K=m,Q=S("MostlyCloudy"),W=v,Z=f,X=p,ee=g,le=y,ae=V,te=u,ue=b,de=w,oe=h,se=j,he=S("ZoomIn"),Ce=S("Delete"),Ae=x,Oe=S("Plus"),Ee=k,Je=_;return O(),D("div",ne,[T("div",ie,[z(C,{modelValue:Ve.value,"onUpdate:modelValue":l[0]||(l[0]=e=>Ve.value=e),onTabClick:Le},{default:E(()=>[z(U,{label:"基本信息",name:"first"}),z(U,{label:"扩展信息",name:"second"}),De.value.length>0?(O(),N(U,{key:0,label:"模型信息",name:"three"})):R("",!0)]),_:1},8,["modelValue"])]),T("div",re,[z(Ee,{ref_key:"paramsRef",ref:Ie,model:Se,"label-width":"90px"},{default:E(()=>[q((O(),D("div",null,[z(te,{gutter:20},{default:E(()=>[z(P,{sm:24,md:12},{default:E(()=>[z(A,{label:"文章栏目"},{default:E(()=>[z(I,{props:ye,"show-all-levels":!1,modelValue:ge.value,"onUpdate:modelValue":l[1]||(l[1]=e=>ge.value=e),options:_e.value,onChange:Fe},null,8,["modelValue","options"])]),_:1})]),_:1}),z(P,{sm:24,md:12},{default:E(()=>[z(A,{label:"文章标题",prop:"title",rules:[{required:!0,message:"请输入文章标题",trigger:"blur"},{min:1,max:100,message:"标题不能超过100个字",trigger:"blur"}]},{default:E(()=>[z(M,{modelValue:Se.title,"onUpdate:modelValue":l[2]||(l[2]=e=>Se.title=e)},null,8,["modelValue"])]),_:1})]),_:1}),z(P,{sm:24,md:12},{default:E(()=>[z(A,{label:"tag标签"},{default:E(()=>[z($,{modelValue:Se.tagId,"onUpdate:modelValue":l[3]||(l[3]=e=>Se.tagId=e),options:Ue.value,placeholder:"请选择标签",style:{width:"240px"},multiple:"",filterable:"",remote:"","remote-method":Be},null,8,["modelValue","options"])]),_:1})]),_:1}),z(P,{sm:24,md:12},{default:E(()=>[z(A,{label:"内容属性"},{default:E(()=>[z(H,{modelValue:Se.attr,"onUpdate:modelValue":l[4]||(l[4]=e=>Se.attr=e),onChange:Pe},{default:E(()=>[z(G,{label:"1",value:"1"},{default:E(()=>[...l[24]||(l[24]=[L("头条",-1)])]),_:1}),z(G,{label:"2",value:"2"},{default:E(()=>[...l[25]||(l[25]=[L("推荐",-1)])]),_:1}),z(G,{label:"3",value:"3"},{default:E(()=>[...l[26]||(l[26]=[L("轮播",-1)])]),_:1}),z(G,{label:"4",value:"4"},{default:E(()=>[...l[27]||(l[27]=[L("热门",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),z(P,{sm:24,md:12},{default:E(()=>[z(A,{label:"发布时间"},{default:E(()=>[z(K,{modelValue:Se.createdAt,"onUpdate:modelValue":l[5]||(l[5]=e=>Se.createdAt=e),type:"datetime",placeholder:"选择日期时间"},null,8,["modelValue"])]),_:1})]),_:1}),z(P,{sm:24,md:12},{default:E(()=>[z(A,{class:"flex",label:"缩略图"},{default:E(()=>[z(X,{class:"avatar-uploader","http-request":$e,"show-file-list":!1,"before-upload":Me},{default:E(()=>[z(Z,{placement:"top-start",title:"上传",width:200,trigger:"hover",content:"上传图片作为封面图，大小200k内"},{reference:E(()=>[z(W,{class:"avatar-uploader-icon"},{default:E(()=>[z(Q)]),_:1})]),_:1})]),_:1}),Se.img?(O(),N(Z,{key:0,placement:"right",width:400,trigger:"hover"},{reference:E(()=>[z(ee,{class:"avatar-uploader-icon pointer ml-10",src:Se.img},null,8,["src"])]),default:E(()=>[z(ee,{style:{width:"100%"},src:Se.img},null,8,["src"])]),_:1})):R("",!0),z(le,{type:"primary",class:"ml-10",onClick:l[6]||(l[6]=e=>Ne.value=!0)},{default:E(()=>[...l[28]||(l[28]=[L(" 默认封面图 ",-1)])]),_:1}),z(ae,{modelValue:Ne.value,"onUpdate:modelValue":l[7]||(l[7]=e=>Ne.value=e),title:"默认封面图",class:"w-300","with-header":!1},{default:E(()=>[T("div",ce,[(O(!0),D(B,null,F(Re.value,(e,l)=>(O(),N(ee,{key:l,src:e,onClick:l=>{return a=e,void(Se.img=a);var a},fit:"cover"},null,8,["src","onClick"]))),128))])]),_:1},8,["modelValue"]),z(M,{class:"ml-10 flex-1",modelValue:Se.img,"onUpdate:modelValue":l[8]||(l[8]=e=>Se.img=e)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),z(A,{label:"内容摘要"},{default:E(()=>[z(M,{type:"textarea",rows:2,placeholder:"请输入内容",modelValue:Se.description,"onUpdate:modelValue":l[9]||(l[9]=e=>Se.description=e)},null,8,["modelValue"])]),_:1}),z(A,{label:"文章内容"},{default:E(()=>[z(Y,{modelValue:Se.content,"onUpdate:modelValue":l[10]||(l[10]=e=>Se.content=e),setting:fe.value,onInit:qe,"script-src":"/public/admin/tinymce/tinymce.min.js"},null,8,["modelValue","setting"])]),_:1}),z(te,{gutter:20},{default:E(()=>[z(P,{sm:24,md:12,lg:8},{default:E(()=>[z(A,{label:"自动封面"},{default:E(()=>[z(G,{modelValue:je.value,"onUpdate:modelValue":l[12]||(l[12]=e=>je.value=e)},{default:E(()=>[l[29]||(l[29]=L(" 文章第 ",-1)),z(M,{modelValue:ke.value,"onUpdate:modelValue":l[11]||(l[11]=e=>ke.value=e),class:"w-80 mr-8 ml-8",placeholder:"请输入内容"},null,8,["modelValue"]),l[30]||(l[30]=L("张图 ",-1))]),_:1},8,["modelValue"])]),_:1})]),_:1}),z(P,{sm:24,md:12,lg:8},{default:E(()=>[z(A,{label:"提取描述"},{default:E(()=>[z(G,{modelValue:xe.value,"onUpdate:modelValue":l[13]||(l[13]=e=>xe.value=e)},{default:E(()=>[...l[31]||(l[31]=[L("提取文章描述",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1}),z(P,{sm:24,md:12,lg:8},{default:E(()=>[z(A,{label:"是否显示"},{default:E(()=>[z(ue,{modelValue:Se.status,"onUpdate:modelValue":l[14]||(l[14]=e=>Se.status=e),value:"0"},{default:E(()=>[...l[32]||(l[32]=[L("发布",-1)])]),_:1},8,["modelValue"]),z(ue,{modelValue:Se.status,"onUpdate:modelValue":l[15]||(l[15]=e=>Se.status=e),value:"1"},{default:E(()=>[...l[33]||(l[33]=[L("不发布",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})])),[[J,0==be.value],[Je,ve.value]]),q(T("div",null,[z(te,{gutter:20},{default:E(()=>[z(P,{sm:24,md:12},{default:E(()=>[z(A,{label:"短标题",prop:"name"},{default:E(()=>[z(M,{modelValue:Se.shortTitle,"onUpdate:modelValue":l[16]||(l[16]=e=>Se.shortTitle=e)},null,8,["modelValue"])]),_:1})]),_:1}),z(P,{sm:24,md:12},{default:E(()=>[z(A,{label:"内容模板"},{default:E(()=>[z(oe,{modelValue:Se.articleView,"onUpdate:modelValue":l[17]||(l[17]=e=>Se.articleView=e),placeholder:"请选择模板"},{default:E(()=>[(O(!0),D(B,null,F(we.value,e=>(O(),N(de,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),z(P,{sm:24,md:12},{default:E(()=>[z(A,{label:"来源"},{default:E(()=>[z(M,{modelValue:Se.source,"onUpdate:modelValue":l[18]||(l[18]=e=>Se.source=e)},null,8,["modelValue"])]),_:1})]),_:1}),z(P,{sm:24,md:12},{default:E(()=>[z(A,{label:"作者"},{default:E(()=>[z(M,{modelValue:Se.author,"onUpdate:modelValue":l[19]||(l[19]=e=>Se.author=e)},null,8,["modelValue"])]),_:1})]),_:1}),z(P,{sm:24,md:12},{default:E(()=>[z(A,{label:"外链跳转"},{default:E(()=>[z(M,{modelValue:Se.link,"onUpdate:modelValue":l[20]||(l[20]=e=>Se.link=e),max:"120"},null,8,["modelValue"])]),_:1})]),_:1}),z(P,{sm:24,md:12},{default:E(()=>[z(A,{label:"浏览数"},{default:E(()=>[z(M,{modelValue:Se.pv,"onUpdate:modelValue":l[21]||(l[21]=e=>Se.pv=e)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})],512),[[J,1==be.value]]),q(T("div",null,[z(te,{gutter:20},{default:E(()=>[(O(!0),D(B,null,F(De.value,(e,a)=>(O(),N(P,{key:a,sm:24,md:24,lg:24},{default:E(()=>[["1","7"].includes(e.type)?(O(),N(A,{key:0,label:e.cname},{default:E(()=>[z(M,{modelValue:e.values,"onUpdate:modelValue":l=>e.values=l,max:"120"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):["2","9"].includes(e.type)?(O(),N(A,{key:1,label:e.cname},{default:E(()=>[z(M,{type:"textarea",rows:4,placeholder:"请输入内容",modelValue:e.values,"onUpdate:modelValue":l=>e.values=l},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):["4"].includes(e.type)?(O(),N(A,{key:2,label:e.cname},{default:E(()=>[z(se,{modelValue:e.values,"onUpdate:modelValue":l=>e.values=l},{default:E(()=>[(O(!0),D(B,null,F(e.defaultVal,e=>(O(),N(ue,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):["3","5"].includes(e.type)?(O(),N(A,{key:3,label:e.cname},{default:E(()=>[z(oe,{modelValue:e.values,"onUpdate:modelValue":l=>e.values=l,placeholder:"请选择"},{default:E(()=>[(O(!0),D(B,null,F(e.defaultVal,e=>(O(),N(de,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):"6"===e.type?(O(),N(A,{key:4,label:e.cname},{default:E(()=>[z(K,{modelValue:e.values,"onUpdate:modelValue":l=>e.values=l,"default-value":new Date,type:"datetime",placeholder:"请选择"},null,8,["modelValue","onUpdate:modelValue","default-value"])]),_:2},1032,["label"])):"8"===e.type?(O(),N(A,{key:5,label:e.cname,class:"flex align-c justify-center"},{default:E(()=>[e?.values?.length>0?(O(),D("div",me,[(O(!0),D(B,null,F(e.values,(e,l)=>(O(),D("div",{class:"pos-r img-item",key:e.url},[(O(),N(ee,{key:l,src:e.url,fit:"cover"},null,8,["src"])),T("div",pe,[z(W,{onClick:l=>(e=>{Te.value=e.url,ze.value=!0})(e)},{default:E(()=>[z(he)]),_:1},8,["onClick"]),z(W,{onClick:l=>(async e=>{De.value.forEach(l=>{Array.isArray(l.values)&&l.values.forEach((a,t)=>{a.url==e.url&&(Ke(e.url),l.values.splice(t,1))})})})(e)},{default:E(()=>[z(Ce)]),_:1},8,["onClick"])])]))),128))])):R("",!0),z(Ae,{modelValue:ze.value,"onUpdate:modelValue":l[22]||(l[22]=e=>ze.value=e)},{default:E(()=>[z(ee,{"w-full":"",src:Te.value,alt:"Preview Image"},null,8,["src"])]),_:1},8,["modelValue"]),z(X,{multiple:"","http-request":He,data:{...e,index:a},"before-upload":Ge,limit:10,"show-file-list":!1},{default:E(()=>[z(W,{class:"upload-icon"},{default:E(()=>[z(Oe)]),_:1})]),_:1},8,["data"])]),_:2},1032,["label"])):R("",!0)]),_:2},1024))),128))]),_:1})],512),[[J,2==be.value&&De.value.length>0]]),z(A,null,{default:E(()=>[z(le,{type:"primary",onClick:l[23]||(l[23]=e=>Qe(Ie.value))},{default:E(()=>[...l[34]||(l[34]=[L("保存",-1)])]),_:1})]),_:1})]),_:1},8,["model"])])])}}},[["__scopeId","data-v-f9faf703"]]))}}});
