import{g as V,u as $,I as z,v as F,x as H,y as K,a as C}from"./element-plus.js";import{a as O,u as P}from"./vue-router.js";import{H as U,F as A}from"./@element-plus.js";import{l as G,a as J}from"./field.js";import{h as Q}from"./model.js";import{r as l,n as W,ab as X,aq as k,c as Y,o as c,O as o,T as i,L as r,K as p,a3 as Z,u as x}from"./@vue.js";import"./dayjs.js";import"./ace-builds.js";import"./lodash-es.js";import"./@popperjs.js";import"./async-validator.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./index.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css     */const ee={class:"bg-fff radius-6 pd-20"},ke={__name:"index",setup(te){const E=O(),N=P(),s=l({mid:E.query.mid}),d=l(""),_=l(""),q=l([]),f=l([]),v=l(0),b=l(1),g=l(!0),u=async()=>{try{const e=await G(s.value.mid,b.value);if(e.code===200){const t=e.data;f.value=[...t.list],d.value=t.model.model,_.value=t.model.tableName,v.value=t.count,g.value=!1}}catch(e){console.error(e)}},B=e=>{q.value=e},D=e=>{b.value=Number(e),sessionStorage.setItem("cur",Number(e)),u()},T=e=>{const{id:t,ename:a}=e;N.push({name:"field-edit",query:{fid:t,mid:s.value.mid,table:a,model:d.value}})},S=async e=>{let{id:t}=e;try{(await Q(s.value.mid)).data.count===0?(await J(t)).code===200&&(C({message:"删除成功 ^_^",type:"success"}),u()):C({message:"当前模型正在使用，字段不能删除 ^_^",type:"warning"})}catch(a){console.error(a)}};return W(()=>{u()}),(e,t)=>{const a=V,y=X("router-link"),h=$,n=F,R=H,j=K,m=k("permission-disabled"),I=k("permission"),L=z;return c(),Y("div",ee,[o(h,{type:"flex",justify:"end"},{default:r(()=>[i((c(),p(y,{to:{name:"field-add",query:{mid:s.value.mid,table:_.value,model:d.value}}},{default:r(()=>[i((c(),p(a,{type:"primary",round:""},{default:r(()=>t[0]||(t[0]=[Z("新增")])),_:1})),[[m,["editor","admin","super"]]])]),_:1},8,["to"])),[[I,["editor","admin","super"]]])]),_:1}),i((c(),p(R,{ref:"multipleTable",data:f.value,"tooltip-effect":"dark",style:{width:"100%"},"row-key":"id",onSelectionChange:B},{default:r(()=>[o(n,{type:"selection",width:"55"}),o(n,{prop:"id",label:"编号"}),o(n,{prop:"cname",label:"中文名称"}),o(n,{prop:"ename",label:"字段名称"}),o(n,{prop:"orderBy",label:"排序"}),o(n,{fixed:"right",label:"操作",width:"150"},{default:r(w=>[i(o(a,{icon:x(U),circle:"",onClick:M=>T(w.row)},null,8,["icon","onClick"]),[[m,["editor","admin","super"]]]),i(o(a,{icon:x(A),circle:"",onClick:M=>S(w.row)},null,8,["icon","onClick"]),[[m,["editor","admin","super"]]])]),_:1})]),_:1},8,["data"])),[[L,g.value]]),o(h,{type:"flex",class:"mt-20",justify:"space-between"},{default:r(()=>[o(j,{background:"",layout:"prev, pager, next",onCurrentChange:D,"page-size":10,total:v.value,"hide-on-single-page":""},null,8,["total"])]),_:1})])}}};export{ke as default};
