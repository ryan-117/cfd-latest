import{r as te,N as oe,s as ae,f as le,q as re,F as ne,I as se,v as ie,x as ce,y as de,u as ue,E as k,A as me}from"./element-plus.js";import{u as pe,a as fe}from"./vue-router.js";import{I as _e,i as ve,v as ye,H as we,F as ge}from"./@element-plus.js";import{s as he,b as F}from"./article.js";import{f as ke}from"./category.js";import{_ as be,a as Ce,t as xe}from"./index.js";import{r,W as Ee,w as $e,n as Se,aj as Ve,ar as Be,c as P,o as m,a as b,V as o,L as l,u as p,a3 as f,S as _,K as C,H as Re,P as q}from"./@vue.js";import"./dayjs.js";import"./ace-builds.js";import"./lodash-es.js";import"./@popperjs.js";import"./async-validator.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css     */const Te={class:"bg-fff radius-6 pd-20 mb-10"},Fe={class:"radius-6 bg-fff pd-20"},Pe={class:"flex justify-between align-c"},qe=["href"],De={__name:"index",setup(Ie){const w=pe(),D=fe(),v=r(location.origin),x=r(null),I=r(null),g=r(!0),E=r([]),$=r([]),S=r(0),s=r(1),d=r(0),V=r([]),n=Ee({keywords:"",categorySelected:[]}),B=e=>{e&&x.value.resetFields(),w.replace({name:"article-index",query:{cur:1,cid:0,keywords:""}}),s.value=1,n.keywords="",d.value=0,u()},R=()=>{w.replace({name:"article-index",query:{cur:s.value,cid:d.value,keywords:n.keywords}}),u()},u=async()=>{try{g.value=!0;const e=await he(s.value,n.keywords,d.value);e.code===200&&(E.value=[...e.data.list],S.value=e.data.count,s.value=e.data.current,g.value=!1)}catch(e){console.error(e)}},N=e=>{s.value=e,R()},j=e=>{$.value=e},A=async()=>{try{const e=await ke();if(e.code===200){const t=Ce(xe(e.data));V.value=[...t]}}catch(e){console.error(e)}},L=e=>{d.value=e[e.length-1]},M=e=>{w.push({name:"article-edit",params:{id:e.id}})},U=()=>{},H=async()=>{const e=$.value.map(t=>t.id).join(",");try{(await F(e)).code===200&&(k({message:"删除成功 ^_^",type:"success"}),u())}catch(t){console.error(t)}},z=e=>{const t=e.type=="0"?"".concat(v.value,"/article-").concat(e.id,".html"):"".concat(v.value).concat(e.path,"/page-").concat(e.id,".html");window.open(t)},K=e=>{me.confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{(await F(e.id)).code===200&&(k({message:"文章删除成功 ^_^",type:"success"}),u())}catch(t){console.error(t)}}).catch(()=>{k({type:"info",message:"已取消删除"})})};return $e(()=>D.query,e=>{s.value=e.cur,d.value=e.cid,n.keywords=e.keywords||"",u()},{immediate:!0}),Se(()=>{A()}),(e,t)=>{const W=oe,h=te,G=ae,i=le,J=re,O=ne,X=Ve("router-link"),c=ie,Y=ce,Z=de,Q=ue,y=Be("permission-disabled"),ee=se;return m(),P("div",null,[b("div",Te,[o(J,{inline:!0,model:n,"label-width":"68px",ref_key:"formRef",ref:x},{default:l(()=>[o(h,{label:"栏目筛选",prop:"categorySelected"},{default:l(()=>[o(W,{"show-all-levels":!1,modelValue:n.categorySelected,"onUpdate:modelValue":t[0]||(t[0]=a=>n.categorySelected=a),options:V.value,onChange:L},null,8,["modelValue","options"])]),_:1}),o(h,{label:"标题",prop:"keywords"},{default:l(()=>[o(G,{placeholder:"请输入文章标题","suffix-icon":p(_e),modelValue:n.keywords,"onUpdate:modelValue":t[1]||(t[1]=a=>n.keywords=a),clearable:"",onClear:B},null,8,["suffix-icon","modelValue"])]),_:1}),o(h,null,{default:l(()=>[o(i,{type:"primary",onClick:R,round:""},{default:l(()=>[...t[4]||(t[4]=[f("搜索",-1)])]),_:1}),o(i,{onClick:t[2]||(t[2]=a=>B("formRef")),round:""},{default:l(()=>[...t[5]||(t[5]=[f("清空",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),b("div",Fe,[b("div",Pe,[o(O,{"confirm-button-text":"确定","cancel-button-text":"取消",icon:p(ve),"icon-color":"#626AEF",title:"此操作将永久删除, 是否继续?",onConfirm:H,onCancel:U},{reference:l(()=>[_((m(),C(i,null,{default:l(()=>[...t[6]||(t[6]=[f("删除",-1)])]),_:1})),[[y,["editor","admin","super"]]])]),_:1},8,["icon"]),_((m(),C(X,{class:"mt-10",to:"/article/add"},{default:l(()=>[o(i,{type:"primary",round:""},{default:l(()=>[...t[7]||(t[7]=[f("新增",-1)])]),_:1})]),_:1})),[[y,["editor","admin","super"]]])]),_((m(),C(Y,{ref_key:"multipleTableRef",ref:I,data:E.value,"tooltip-effect":"dark","row-key":"id",onSelectionChange:j},{default:l(()=>[o(c,{type:"selection"}),o(c,{prop:"id",label:"编号",width:"80",fixed:""}),o(c,{prop:"title",label:"标题"},{default:l(a=>[a.row.status===0?(m(),P("a",{key:0,class:"block",href:a.row.type=="0"?"".concat(v.value,"/article-").concat(a.row.id,".html"):"".concat(v.value).concat(a.row.path,"/page-").concat(a.row.id,".html"),target:"_blank"},q(a.row.title),9,qe)):Re("",!0)]),_:1}),o(c,{prop:"name",label:"栏目",width:"80"}),o(c,{prop:"createdAt",label:"更新时间",width:"170"}),o(c,{prop:"status",label:"状态",width:"60"},{default:l(a=>[f(q(a.row.status==0?"显示":"隐藏"),1)]),_:1}),o(c,{fixed:"right",label:"操作",width:"150"},{default:l(a=>[o(i,{icon:p(ye),circle:"",onClick:T=>z(a.row)},null,8,["icon","onClick"]),_(o(i,{icon:p(we),circle:"",onClick:T=>M(a.row)},null,8,["icon","onClick"]),[[y,["editor","admin","super"]]]),_(o(i,{icon:p(ge),circle:"",onClick:T=>K(a.row)},null,8,["icon","onClick"]),[[y,["editor","admin","super"]]])]),_:1})]),_:1},8,["data"])),[[ee,g.value]]),o(Q,{type:"flex",class:"mt-20",justify:"space-between"},{default:l(()=>[o(Z,{background:"",layout:"prev, pager, next",onCurrentChange:N,"page-size":20,total:S.value,currentPage:s.value,"onUpdate:currentPage":t[3]||(t[3]=a=>s.value=a),"hide-on-single-page":""},null,8,["total","currentPage"])]),_:1})])])}}},lt=be(De,[["__scopeId","data-v-d1fe6908"]]);export{lt as default};
