import{r as B,s as N,L as R,M as q,g as F,q as I,a as m}from"./element-plus.js";import{a as h,u as O}from"./vue-router.js";import{d as L,u as M}from"./field.js";import{h as j}from"./model.js";import{_ as C}from"./index.js";import{r as S,W as T,n as D,c as d,o as i,O as a,L as n,I as W,ac as z,a as A,a3 as G}from"./@vue.js";import"./dayjs.js";import"./ace-builds.js";import"./@element-plus.js";import"./lodash-es.js";import"./@popperjs.js";import"./async-validator.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css     */const H={class:"bg-fff pd-20 radius-6"},J={__name:"edit",setup(K){const u=S(null),l=T({id:"",mid:"",tableName:"",cname:"",ename:"",type:"",val:"",defaultVal:"",length:"",orderBy:"0"}),p=[{value:"1",label:"单行文本"},{value:"2",label:"多行文本 "},{value:"3",label:"下拉菜单"},{value:"4",label:"单选"},{value:"5",label:"多选 "},{value:"6",label:"时间和日期 "},{value:"7",label:"数字 "},{value:"8",label:"多图上传 "},{value:"9",label:"富文本 "}],c=[{required:!0,message:"请输入中文名称",trigger:"blur"}],f=[{required:!0,message:"请输入英文名称",trigger:"blur"}],b=[{required:!0,message:"请选择类型",trigger:"blur"}],_=h(),g=O();D(async()=>{const{fid:o,mid:e,tableName:s}=_.query;l.id=o,l.mid=e,l.tableName=s,await V()});const V=async()=>{try{const o=await L(l.id);o.code===200&&(Object.assign(l,o.data,{old_ename:o.data.ename}),y(l.mid))}catch(o){console.error(o)}},y=async o=>{var e,s;try{const r=await j(o);((s=(e=r==null?void 0:r.data)==null?void 0:e.has)==null?void 0:s.length)>0?console.log("Field is used"):console.log("Field is not used")}catch(r){console.log(r)}},v=()=>{u.value.validate(async o=>{if(o)await U();else return console.log("error submit!!"),!1})},U=async()=>{try{const o=await M(l);o.code===200?m({message:"更新成功^_^",type:"success"}):m({message:o.msg,type:"error"}),g.go(-1)}catch(o){console.log(o)}};return(o,e)=>{const s=N,r=B,w=q,E=R,k=F,x=I;return i(),d("div",H,[a(x,{ref_key:"formRef",ref:u,model:l,"label-width":"100px",class:"mt-20"},{default:n(()=>[a(r,{label:"中文名称",prop:"cname",rules:c},{default:n(()=>[a(s,{modelValue:l.cname,"onUpdate:modelValue":e[0]||(e[0]=t=>l.cname=t),placeholder:"请输入字段中文名称"},null,8,["modelValue"])]),_:1}),a(r,{label:"字段名称",prop:"ename",rules:f},{default:n(()=>[a(s,{modelValue:l.ename,"onUpdate:modelValue":e[1]||(e[1]=t=>l.ename=t),placeholder:"请输入英文小驼峰方式，例：bookName"},null,8,["modelValue"])]),_:1}),a(r,{label:"字段类型",rules:b},{default:n(()=>[a(E,{modelValue:l.type,"onUpdate:modelValue":e[2]||(e[2]=t=>l.type=t),placeholder:"请选择"},{default:n(()=>[(i(),d(W,null,z(p,t=>a(w,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),a(r,{label:"字段选项"},{default:n(()=>[a(s,{modelValue:l.defaultVal,"onUpdate:modelValue":e[3]||(e[3]=t=>l.defaultVal=t),rows:2,type:"textarea",placeholder:"单选、多选、下拉框，请填写json格式。"},null,8,["modelValue"]),e[7]||(e[7]=A("p",{class:"f-12 c-999"},'例如：{"options":[{"label":"本地下载","value":"1"},{"label":"电信下载","value":"2"}]}',-1))]),_:1}),a(r,{label:"默认值"},{default:n(()=>[a(s,{modelValue:l.val,"onUpdate:modelValue":e[4]||(e[4]=t=>l.val=t)},null,8,["modelValue"])]),_:1}),a(r,{label:"排序"},{default:n(()=>[a(s,{modelValue:l.orderBy,"onUpdate:modelValue":e[5]||(e[5]=t=>l.orderBy=t)},null,8,["modelValue"])]),_:1}),a(r,{label:"字段长度"},{default:n(()=>[a(s,{modelValue:l.length,"onUpdate:modelValue":e[6]||(e[6]=t=>l.length=t)},null,8,["modelValue"])]),_:1}),a(r,null,{default:n(()=>[a(k,{type:"primary",onClick:v},{default:n(()=>e[8]||(e[8]=[G("保存")])),_:1})]),_:1})]),_:1},8,["model"])])}}},be=C(J,[["__scopeId","data-v-692047c4"]]);export{be as default};
