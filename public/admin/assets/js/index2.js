import{g as A,u as H,v as L,w as R,b as U,x as j,y as z,A as F,a as v}from"./element-plus.js";import{u as I}from"./vue-router.js";import{v as K,H as O,F as P,B as Q}from"./@element-plus.js";import{l as W,D as G,r as J}from"./dialog.js";import{g as X}from"./index.js";import{r as p,W as Y,w as Z,n as ee,aq as te,c as oe,o as m,O as t,a as ae,L as l,T as u,K as h,a3 as w,Q as ie,H as le,u as n}from"./@vue.js";import"./dayjs.js";import"./ace-builds.js";import"./lodash-es.js";import"./@popperjs.js";import"./async-validator.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css     */const ne={class:"bg-fff radius-6 pd-20"},se={class:"mr-10 ml-10"},De={__name:"index",setup(re){const y=p([]),_=p(0),f=p(1),g=X("username"),o=Y({dialogVisible:!1,id:0,params:{},list:[]}),C=I();Z(()=>o.dialogVisible,e=>{e||c()});const c=async()=>{try{const e=await W();e.code===200&&(o.list=[...e.data.list],_.value=e.data.total)}catch(e){console.log(e)}},k=e=>{f.value=e,c()},x=e=>{y.value=e},E=e=>{o.id=e.id,o.dialogVisible=!0},V=()=>{o.id=0,o.dialogVisible=!0},B=e=>{let{type_code:a}=e;C.push({name:"config",params:{id:a}})},T=async e=>{F.confirm("将会删除当前类型下所有配置，确定要继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{D(e)}).catch(()=>{v({type:"info",message:"取消成功"})})},D=async e=>{try{const{id:a}=e;(await J({id:a})).code===200&&(v.success("删除成功 ^_^"),c())}catch(a){console.log(a)}};return ee(()=>{c()}),(e,a)=>{const s=A,M=H,r=L,N=U,S=R,$=j,q=z,d=te("permission-disabled");return m(),oe("div",ne,[t(M,{type:"flex",justify:"end"},{default:l(()=>[u((m(),h(s,{type:"primary",onClick:V,round:""},{default:l(()=>a[1]||(a[1]=[w("新增")])),_:1})),[[d,["editor","admin","super"]]])]),_:1}),ae("div",se,[t($,{data:o.list,"tooltip-effect":"dark","row-key":"id",onSelectionChange:x},{default:l(()=>[t(r,{prop:"id",width:"100",label:"编号"}),t(r,{prop:"type_code",label:"标识"}),t(r,{prop:"type_name",label:"名称"}),t(r,{prop:"status",label:"是否启用"},{default:l(i=>[w(ie(i.row.status==1?"启用":"关闭"),1)]),_:1}),t(r,{fixed:"right",width:"200",label:"操作"},{default:l(i=>[t(s,{icon:n(K),circle:"",onClick:b=>B(i.row)},null,8,["icon","onClick"]),u(t(s,{icon:n(O),circle:"",onClick:b=>E(i.row)},null,8,["icon","onClick"]),[[d,["editor","admin","super"]]]),u(t(s,{icon:n(P),onClick:b=>T(i.row),disabled:n(g)===i.row.username,circle:""},null,8,["icon","onClick","disabled"]),[[d,["editor","admin","super"]]]),n(g)===i.row.username?(m(),h(S,{key:0,content:"当前登录用户不可删除",effect:"light",placement:"top-start"},{default:l(()=>[t(N,{class:"ml-10 t-4 pointer"},{default:l(()=>[t(n(Q),{class:"c-165dff"})]),_:1})]),_:1})):le("",!0)]),_:1})]),_:1},8,["data"]),t(q,{background:"",layout:"prev, pager, next",total:_.value,"page-size":10,"model-value":f.value,"onUpdate:modelValue":k,"hide-on-single-page":""},null,8,["total","model-value"])]),t(G,{visible:o.dialogVisible,"onUpdate:visible":a[0]||(a[0]=i=>o.dialogVisible=i),id:o.id},null,8,["visible","id"])])}}};export{De as default};
