import{a as _,q as D,r as O,s as R,u as q,G as z,B as F,C as G,g as W,D as K}from"./element-plus.js";import{r as u,e as U,w as x,c as H,o as $,O as a,u as J,W as Q,K as X,L as s,a3 as w,a as Y,P as Z}from"./@vue.js";import{V as ee}from"./vue3-ace-editor.js";import"./ace-builds.js";import{_ as M,h as g,A as v}from"./index.js";const te={class:"editor-container"},oe={__name:"code",props:{contentId:{type:[String,Number],required:!0},fileType:{type:String,default:"json",validator:l=>["html","css","js","javascript","json","text"].includes(l.toLowerCase())},content:{type:String,default:""}},emits:["save","refresh"],setup(l,{emit:A}){const n=l,d=u(n.content),y=u(n.content),p=u(!1),b=u(null),h=U(()=>({html:"html",css:"css",js:"javascript",javascript:"javascript",json:"json"})[n.fileType.toLowerCase()]||"text"),k=u({fontSize:14,tabSize:2,showLineNumbers:!0,highlightActiveLine:!0,wrap:!0,useWorker:!1,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,showPrintMargin:!1,behavioursEnabled:!0}),o=A,m=r=>{r.selection.on("changeCursor",()=>{b.value=r.selection.getCursor()})},S=()=>{p.value=d.value!==y.value,o("save",{content:d.value})};return x(()=>n.content,r=>{d.value!==r&&(d.value=r,y.value=r,p.value=!1)}),(r,C)=>($(),H("div",te,[a(J(ee),{value:d.value,"onUpdate:value":C[0]||(C[0]=I=>d.value=I),lang:h.value,theme:"monokai",options:k.value,onInit:m,onChange:S,style:{height:"100%",width:"100%"}},null,8,["value","lang","options"])]))}},ae=M(oe,[["__scopeId","data-v-be28ad88"]]);let _e=(l={})=>g({url:"".concat(v.BASE_API,"/base/config/list"),method:"get",params:l}),le=(l={})=>g({url:"".concat(v.BASE_API,"/base/config/create"),method:"post",data:l}),se=(l={})=>g({url:"".concat(v.BASE_API,"/base/config/detail"),method:"get",params:l}),ne=(l={})=>g({url:"".concat(v.BASE_API,"/base/config/update"),method:"post",data:l}),ge=(l={})=>g({url:"".concat(v.BASE_API,"/base/config/delete"),method:"get",params:l});const re={class:"dialog-footer"},ie={__name:"dialog",props:{visible:{type:Boolean,default:!1},id:{type:Number,default:0},type_code:{type:String,default:""}},emits:["update:visible"],setup(l,{emit:A}){const n=l,d=u(1),y=u("json"),p=u('{"name": "test"}'),b=u(null),h=A,k=U({get:()=>n.visible,set:t=>h("update:visible",t)}),o=Q({form:{type_code:"",config_key:"",config_value:"",status:"1",remark:""}}),m=()=>{o.form={config_key:"",config_value:"",status:"1",remark:""},o.form.type_code=n.type_code,h("update:visible",!1)};x(()=>n.type_code,async t=>{o.form.type_code=t}),x(()=>n.visible,async t=>{if(t&&n.id>0)try{const e=Number(n.id);o.form.id=e,await I(e)}catch(e){_.error(e)}});const S=t=>{o.form.config_value=t.content},r=async()=>{try{let t=o.form;const e=await le(t);e.code===200?(_({message:"创建成功 ^_^",type:"success"}),m()):_({message:e.msg,type:"error"})}catch(t){console.log(t)}},C=async()=>{try{let t=o.form;const e=await ne(t);e.code===200?(_({message:"更新成功 ^_^",type:"success"}),m()):_({message:e.msg,type:"error"})}catch(t){console.log(t)}},I=async t=>{try{let e=await se({id:t});if(e.code==200){let{id:f,config_key:c,config_value:V,type_code:j,status:E,remark:B}=e.data;o.form={id:f,config_key:c,config_value:V,type_code:j,status:E,remark:B},p.value=V}}catch(e){console.error(e)}},N=t=>{t&&t.validate(e=>{if(e)o.form.id>0?C():r();else return console.log("error submit!!"),!1})};return(t,e)=>{const f=R,c=O,V=z,j=q,E=G,B=F,T=D,P=W,L=K;return $(),X(L,{modelValue:k.value,"onUpdate:modelValue":e[5]||(e[5]=i=>k.value=i),title:"配置",width:"80%",onClose:m},{footer:s(()=>[Y("span",re,[a(P,{onClick:Z(m,["stop"])},{default:s(()=>e[8]||(e[8]=[w("取消")])),_:1}),a(P,{type:"primary",onClick:e[4]||(e[4]=i=>N(b.value))},{default:s(()=>e[9]||(e[9]=[w("确定")])),_:1})])]),default:s(()=>[a(T,{model:o.form,ref_key:"formRef",ref:b,"label-width":"84px"},{default:s(()=>[a(c,{label:"类型标识",prop:"type_code"},{default:s(()=>[a(f,{modelValue:o.form.type_code,"onUpdate:modelValue":e[0]||(e[0]=i=>o.form.type_code=i),disabled:""},null,8,["modelValue"])]),_:1}),a(c,{label:"配置名称",prop:"config_key"},{default:s(()=>[a(f,{modelValue:o.form.config_key,"onUpdate:modelValue":e[1]||(e[1]=i=>o.form.config_key=i),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),a(c,{label:"配置键值",prop:"config_value"},{default:s(()=>[a(j,{class:"w-full"},{default:s(()=>[a(V,{span:24},{default:s(()=>[a(ae,{"content-id":d.value,"file-type":y.value,content:p.value,onSave:S},null,8,["content-id","file-type","content"])]),_:1})]),_:1})]),_:1}),a(c,{label:"状态"},{default:s(()=>[a(B,{modelValue:o.form.status,"onUpdate:modelValue":e[2]||(e[2]=i=>o.form.status=i)},{default:s(()=>[a(E,{label:"显示",value:"1"},{default:s(()=>e[6]||(e[6]=[w("正常")])),_:1}),a(E,{label:"隐藏",value:"2"},{default:s(()=>e[7]||(e[7]=[w("停用")])),_:1})]),_:1},8,["modelValue"])]),_:1}),a(c,{label:"备注",prop:"remark"},{default:s(()=>[a(f,{type:"textarea",modelValue:o.form.remark,"onUpdate:modelValue":e[3]||(e[3]=i=>o.form.remark=i),placeholder:"例：qiniu.oss"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}},ue=M(ie,[["__scopeId","data-v-d4653870"]]),ve=Object.freeze(Object.defineProperty({__proto__:null,default:ue},Symbol.toStringTag,{value:"Module"}));export{ue as D,ve as d,_e as l,ge as r};
