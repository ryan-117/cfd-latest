import{a as i,I as N,r as O,s as S,S as T,T as j,b as F,U as L,g as z,q as H}from"./element-plus.js";import{a as K,u as P}from"./vue-router.js";import{d as W,u as $}from"./slide.js";import{u as A}from"./upload.js";import{t as G,_ as J}from"./tinymce.js";import{r as f,W as _,n as g,ab as Q,c as X,o as c,T as Y,K as y,L as r,O as o,H as Z,a3 as ee}from"./@vue.js";import"./dayjs.js";import"./ace-builds.js";import"./@element-plus.js";import"./lodash-es.js";import"./@popperjs.js";import"./async-validator.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./index.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css     */const te={class:"bg-fff pd-20 radius-6"},he={__name:"edit",setup(oe){const U=K(),v=P(),u=f(null),b=_(G),m=f(!0);g(async()=>{m.value=!1});const V=()=>{m.value=!1},k={imgUrl:[{required:!0,message:"请上传图片",trigger:"blur"}]},t=_({id:0,title:"",imgUrl:"",content:"",linkUrl:""});g(async()=>{t.id=parseInt(U.params.id,10),await w()});async function w(){try{let e=await W(t.id);e.code===200?Object.assign(t,e.data):i({message:e.msg,type:"error"})}catch(e){console.error(e)}}function E(e){return e.type.indexOf("image")===-1?(i("上传文件只能是图片格式"),!1):e.size/1024>200?(i("上传图片必须小于200k"),!1):!0}async function h(e){const l=new FormData;l.append("file",e.file);try{let a=await A(l,"1");a.code===200&&(t.imgUrl=a.data.path)}catch(a){console.error(a)}}async function x(){try{let e=await $(t);e.code==200?(i({message:"更新成功^_^",type:"success"}),v.go(-1)):i({message:e.msg,type:"error"})}catch(e){console.log(e)}}function I(){u.value.validate(e=>{if(e)x();else return console.log("error submit!!"),!1})}return(e,l)=>{const a=S,n=O,C=Q("MostlyCloudy"),B=F,p=j,D=T,d=L,M=z,R=H,q=N;return c(),X("div",te,[Y((c(),y(R,{ref_key:"formRef",ref:u,model:t,"label-width":"84px",class:"mt-20",rules:k},{default:r(()=>[o(n,{label:"轮播标题",prop:"title"},{default:r(()=>[o(a,{modelValue:t.title,"onUpdate:modelValue":l[0]||(l[0]=s=>t.title=s)},null,8,["modelValue"])]),_:1}),o(n,{class:"flex",label:"轮播图"},{default:r(()=>[o(D,{class:"avatar-uploader","http-request":h,"show-file-list":!1,"before-upload":E},{default:r(()=>[o(p,{placement:"top-start",title:"上传",width:200,trigger:"hover",content:"上传图片作为封面图，大小200k内"},{reference:r(()=>[o(B,{class:"avatar-uploader-icon"},{default:r(()=>[o(C)]),_:1})]),_:1})]),_:1}),t.imgUrl?(c(),y(p,{key:0,placement:"right",width:600,trigger:"hover"},{reference:r(()=>[o(d,{class:"avatar-uploader-icon pointer ml-10",src:t.imgUrl},null,8,["src"])]),default:r(()=>[o(d,{style:{width:"100%"},src:t.imgUrl},null,8,["src"])]),_:1})):Z("",!0),o(a,{class:"ml-10 flex-1",modelValue:t.imgUrl,"onUpdate:modelValue":l[1]||(l[1]=s=>t.imgUrl=s)},null,8,["modelValue"])]),_:1}),o(n,{label:"轮播链接"},{default:r(()=>[o(a,{modelValue:t.linkUrl,"onUpdate:modelValue":l[2]||(l[2]=s=>t.linkUrl=s)},null,8,["modelValue"])]),_:1}),o(n,{label:"轮播文案"},{default:r(()=>[o(J,{modelValue:t.content,"onUpdate:modelValue":l[3]||(l[3]=s=>t.content=s),setting:b,onInit:V,"script-src":"/public/admin/tinymce/tinymce.min.js"},null,8,["modelValue","setting"])]),_:1}),o(n,null,{default:r(()=>[o(M,{type:"primary",onClick:I},{default:r(()=>l[4]||(l[4]=[ee("保存")])),_:1})]),_:1})]),_:1},8,["model"])),[[q,m.value]])])}}};export{he as default};
