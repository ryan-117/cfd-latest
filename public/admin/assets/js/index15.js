import{f as N,u as R,v as A,x as I,y as M,E as u}from"./element-plus.js";import{u as U}from"./vue-router.js";import{H as z,F,J as H}from"./@element-plus.js";import{l as J,a as K,g as L}from"./gather.js";import{c as W}from"./article.js";import{_ as q}from"./index.js";import{r as c,W as G,n as O,aj as Q,ar as X,c as Y,o as y,V as e,L as n,S as m,K as E,a3 as v,P as Z,u as h}from"./@vue.js";import"./dayjs.js";import"./ace-builds.js";import"./lodash-es.js";import"./@popperjs.js";import"./async-validator.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css     */const tt={class:"bg-fff radius-6 pd-20"},et={__name:"index",setup(ot){const x=U(),b=c([]),D=c([]),k=c(0),w=c(1),S=c(0),s=G({cid:0,title:"",shortTitle:"",tagId:"",attr:[],articleView:"",source:"",author:"",description:"",img:"",content:"欢迎使用",status:"0",pv:1,link:""}),_=async()=>{try{let t=await J(w.value);t.code===200&&(b.value=[...t.data.list],k.value=t.data.count)}catch(t){console.error("Error fetching list:",t)}},T=t=>{w.value=t,_()},B=t=>{D.value=t},P=async t=>{var a;try{let{targetUrl:o,title:f,parseData:d,cid:r,status:g}=t,p=await L({targetUrl:o,title:f,parseData:d});if(p.code===200){const{title:l,content:i}=p.data;s.attr=((a=s==null?void 0:s.attr)==null?void 0:a.toString())||"",s.title=l,s.content=i,s.cid=r,s.status=g===1?1:0,V(),u({message:"内功获取成功^_^",type:"success"})}}catch(o){console.error("Error running task:",o)}},V=async()=>{try{(await W({defaultParams:s,fieldParams:{}})).code===200&&u({message:"第".concat(S.value+1,"条数据完成^_^"),type:"success"})}catch(t){console.error("Error creating article:",t)}},$=t=>{let a=t.id;x.push({name:"gather-edit",params:{id:a}})},j=async t=>{let a=t.id;try{let o=await K(a);o.code===200?(u({message:"删除成功 ^_^",type:"success"}),_()):u({message:o.msg,type:"error"})}catch(o){console.error("Error deleting task:",o)}};return O(()=>{_()}),(t,a)=>{const o=N,f=Q("router-link"),d=R,r=A,g=I,p=M,l=X("permission-disabled");return y(),Y("div",tt,[e(d,{type:"flex",justify:"end"},{default:n(()=>[m((y(),E(f,{to:"/gather/add"},{default:n(()=>[e(o,{type:"primary",round:""},{default:n(()=>[...a[0]||(a[0]=[v("新增",-1)])]),_:1})]),_:1})),[[l,["editor","admin","super"]]])]),_:1}),e(g,{ref:"multipleTable",data:b.value,"tooltip-effect":"dark","row-key":"id",onSelectionChange:B},{default:n(()=>[e(r,{type:"selection"}),e(r,{prop:"id",width:"60",label:"编号"}),e(r,{prop:"taskName",label:"任务名称"}),e(r,{prop:"category",label:"所属栏目"}),e(r,{prop:"targetUrl",label:"接口链接"}),e(r,{prop:"status",label:"状态"},{default:n(i=>[v(Z(i.row.status==1?"草稿":"发布"),1)]),_:1}),e(r,{prop:"updatedAt",label:"发布时间"}),e(r,{fixed:"right",width:"222",label:"操作"},{default:n(i=>[m(e(o,{icon:h(z),circle:"",onClick:C=>$(i.row)},null,8,["icon","onClick"]),[[l,["editor","admin","super"]]]),m(e(o,{icon:h(F),circle:"",onClick:C=>j(i.row)},null,8,["icon","onClick"]),[[l,["editor","admin","super"]]]),m((y(),E(o,{type:"primary",round:"",icon:h(H),onClick:C=>P(i.row)},{default:n(()=>[...a[1]||(a[1]=[v("执行",-1)])]),_:1},8,["icon","onClick"])),[[l,["editor","admin","super"]]])]),_:1})]),_:1},8,["data"]),e(d,{type:"flex",class:"mt-20 align-c",justify:"center"},{default:n(()=>[e(p,{background:"",layout:"prev, pager, next",onCurrentChange:T,"page-size":10,total:k.value,"hide-on-single-page":""},null,8,["total"])]),_:1})])}}},Et=q(et,[["__scopeId","data-v-7709cf4b"]]);export{Et as default};
