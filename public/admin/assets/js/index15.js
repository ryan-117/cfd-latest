import{g as R,u as V,v as j,x as A,y as I,a as u}from"./element-plus.js";import{u as U}from"./vue-router.js";import{H as q,F as z,J as F}from"./@element-plus.js";import{l as H,a as J,g as K}from"./gather.js";import{c as L}from"./article.js";import{_ as O}from"./index.js";import{r as c,W as Q,n as W,ab as G,aq as X,c as Y,o as y,O as e,L as n,T as m,K as x,a3 as h,Q as Z,u as v}from"./@vue.js";import"./dayjs.js";import"./ace-builds.js";import"./lodash-es.js";import"./@popperjs.js";import"./async-validator.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css     */const tt={class:"bg-fff radius-6 pd-20"},et={__name:"index",setup(ot){const E=U(),b=c([]),D=c([]),k=c(0),C=c(1),S=c(0),s=Q({cid:0,title:"",shortTitle:"",tagId:"",attr:[],articleView:"",source:"",author:"",description:"",img:"",content:"欢迎使用ChanCMS系统",status:"0",pv:1,link:""}),_=async()=>{try{let t=await H(C.value);t.code===200&&(b.value=[...t.data.list],k.value=t.data.count)}catch(t){console.error("Error fetching list:",t)}},T=t=>{C.value=t,_()},B=t=>{D.value=t},$=async t=>{var a;try{let{targetUrl:o,title:f,parseData:d,cid:r,status:g}=t,p=await K({targetUrl:o,title:f,parseData:d});if(p.code===200){const{title:l,content:i}=p.data;s.attr=((a=s==null?void 0:s.attr)==null?void 0:a.toString())||"",s.title=l,s.content=i,s.cid=r,s.status=g===1?1:0,M(),u({message:"内功获取成功^_^",type:"success"})}}catch(o){console.error("Error running task:",o)}},M=async()=>{try{(await L({defaultParams:s,fieldParams:{}})).code===200&&u({message:"第".concat(S.value+1,"条数据完成^_^"),type:"success"})}catch(t){console.error("Error creating article:",t)}},N=t=>{let a=t.id;E.push({name:"gather-edit",params:{id:a}})},P=async t=>{let a=t.id;try{let o=await J(a);o.code===200?(u({message:"删除成功 ^_^",type:"success"}),_()):u({message:o.msg,type:"error"})}catch(o){console.error("Error deleting task:",o)}};return W(()=>{_()}),(t,a)=>{const o=R,f=G("router-link"),d=V,r=j,g=A,p=I,l=X("permission-disabled");return y(),Y("div",tt,[e(d,{type:"flex",justify:"end"},{default:n(()=>[m((y(),x(f,{to:"/gather/add"},{default:n(()=>[e(o,{type:"primary",round:""},{default:n(()=>a[0]||(a[0]=[h("新增")])),_:1})]),_:1})),[[l,["editor","admin","super"]]])]),_:1}),e(g,{ref:"multipleTable",data:b.value,"tooltip-effect":"dark","row-key":"id",onSelectionChange:B},{default:n(()=>[e(r,{type:"selection"}),e(r,{prop:"id",width:"60",label:"编号"}),e(r,{prop:"taskName",label:"任务名称"}),e(r,{prop:"category",label:"所属栏目"}),e(r,{prop:"targetUrl",label:"接口链接"}),e(r,{prop:"status",label:"状态"},{default:n(i=>[h(Z(i.row.status==1?"草稿":"发布"),1)]),_:1}),e(r,{prop:"updatedAt",label:"发布时间"}),e(r,{fixed:"right",width:"222",label:"操作"},{default:n(i=>[m(e(o,{icon:v(q),circle:"",onClick:w=>N(i.row)},null,8,["icon","onClick"]),[[l,["editor","admin","super"]]]),m(e(o,{icon:v(z),circle:"",onClick:w=>P(i.row)},null,8,["icon","onClick"]),[[l,["editor","admin","super"]]]),m((y(),x(o,{type:"primary",round:"",icon:v(F),onClick:w=>$(i.row)},{default:n(()=>a[1]||(a[1]=[h("执行")])),_:2},1032,["icon","onClick"])),[[l,["editor","admin","super"]]])]),_:1})]),_:1},8,["data"]),e(d,{type:"flex",class:"mt-20 align-c",justify:"center"},{default:n(()=>[e(p,{background:"",layout:"prev, pager, next",onCurrentChange:T,"page-size":10,total:k.value,"hide-on-single-page":""},null,8,["total"])]),_:1})])}}},xt=O(et,[["__scopeId","data-v-3f52528e"]]);export{xt as default};
