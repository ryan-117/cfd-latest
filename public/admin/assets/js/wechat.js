import{a as i,q as g,r as y,s as b,g as w,n as k}from"./element-plus.js";import{a as v,b as V}from"./index23.js";import{W as E,r as h,n as q,c as x,o as F,O as s,L as r,a3 as B}from"./@vue.js";import"./dayjs.js";import"./ace-builds.js";import"./@element-plus.js";import"./lodash-es.js";import"./@popperjs.js";import"./async-validator.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./index.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./vue-router.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css     */const M={class:"mr-10 ml-10"},Y={__name:"wechat",setup(C){const a=E({loading:!0,set:{appid:"",secret:""},list:[]}),p=h(null);q(async()=>{await m()});async function m(){try{const e=await v({type_code:"wechat_minip"});e.code===200?(a.loading=!1,e.data.list.map(t=>{a.set[t.config_key]=t.config_value,a.list.push({query:{id:t.id},params:{config_value:t.config_value,config_key:t.config_key}})})):i({message:e.msg,type:"error"})}catch(e){console.log(e)}}async function c(){try{a.list.map(t=>{t.params.config_value=a.set[t.params.config_key],delete t.params.config_key});let e=a.list;const o=await V(e);o.code===200?(i({message:"更新成功^_^",type:"success"}),await m()):i({message:o.msg,type:"error"})}catch(e){console.log(e)}}function u(){p.value.validate(async e=>{if(e)await c();else return console.log("error submit!!"),!1})}return(e,o)=>{const t=b,l=y,d=w,_=g,f=k;return F(),x("div",M,[s(f,{label:"微信配置",class:"mt-20",name:"wechat"},{default:r(()=>[s(_,{ref_key:"setFormRef",ref:p,model:a.set,"label-width":"80px"},{default:r(()=>[s(l,{label:"appid",prop:"appid",rules:[{required:!0,message:"请输入appid",trigger:"blur"}]},{default:r(()=>[s(t,{modelValue:a.set.appid,"onUpdate:modelValue":o[0]||(o[0]=n=>a.set.appid=n)},null,8,["modelValue"])]),_:1}),s(l,{prop:"secret",label:"secret"},{default:r(()=>[s(t,{modelValue:a.set.secret,"onUpdate:modelValue":o[1]||(o[1]=n=>a.set.secret=n),rules:[{required:!0,message:"请输入secret",trigger:"blur"}]},null,8,["modelValue"])]),_:1}),s(l,null,{default:r(()=>[s(d,{type:"primary",onClick:u},{default:r(()=>o[2]||(o[2]=[B("保存")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}};export{Y as default};
