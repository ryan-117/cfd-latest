import{I as F,r as M,s as j,B as q,C as D,g as L,q as O,a as _}from"./element-plus.js";import{u as S,a as T}from"./vue-router.js";import{d as G,u as H}from"./frag.js";import{t as K,_ as W}from"./tinymce.js";import{_ as $}from"./index.js";import{r as y,W as u,n as g,c as z,o as m,T as A,K as p,L as l,a as J,O as a,H as V,a3 as d}from"./@vue.js";import"./dayjs.js";import"./ace-builds.js";import"./@element-plus.js";import"./lodash-es.js";import"./@popperjs.js";import"./async-validator.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css     */const P={class:"bg-fff pd-20 radius-6"},Q={__name:"edit",setup(X){const b=S(),v=T(),c=y(null),k=u(K),n=y(!0),e=u({id:0,type:1,name:"",mark:"",content:"欢迎使用ChanCMS系统"}),x=u({name:[{required:!0,message:"请输入栏目名称",trigger:"blur"},{min:2,max:50,message:"名称长度在 2 到 50 个字符之间",trigger:"blur"}]}),E=()=>{n.value=!1},w=async()=>{try{const o=await G(e.id);o.code===200&&(Object.assign(e,o.data),e.type===2&&(n.value=!1))}catch(o){console.error(o)}},R=async()=>{try{const o=await H(e);o.code===200?(_({message:"更新成功^_^",type:"success"}),b.go(-1)):_({message:o.msg,type:"error"})}catch(o){console.log(o)}},B=()=>{c.value.validate(o=>{if(o)R();else return console.log("error submit!!"),!1})};return g(async()=>{n.value=!1}),g(async()=>{e.id=parseInt(v.params.id,10),await w()}),(o,t)=>{const i=j,s=M,f=D,C=q,I=L,U=O,N=F;return m(),z("div",P,[A((m(),p(U,{ref_key:"formRef",ref:c,model:e,rules:x,"label-width":"84px",class:"mt-20"},{default:l(()=>[J("div",null,[a(s,{label:"碎片名称",prop:"name"},{default:l(()=>[a(i,{modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=r=>e.name=r)},null,8,["modelValue"])]),_:1}),a(s,{label:"碎片标识",prop:"mark"},{default:l(()=>[a(i,{modelValue:e.mark,"onUpdate:modelValue":t[1]||(t[1]=r=>e.mark=r)},null,8,["modelValue"])]),_:1}),a(s,{label:"碎片类型",prop:"type"},{default:l(()=>[a(C,{modelValue:e.type,"onUpdate:modelValue":t[2]||(t[2]=r=>e.type=r),class:"ml-4"},{default:l(()=>[a(f,{label:1,value:"1"},{default:l(()=>t[5]||(t[5]=[d("富文本")])),_:1}),a(f,{label:2,value:"2"},{default:l(()=>t[6]||(t[6]=[d("文本框")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e.type==1?(m(),p(s,{key:0,label:"碎片内容"},{default:l(()=>[a(W,{modelValue:e.content,"onUpdate:modelValue":t[3]||(t[3]=r=>e.content=r),setting:k,onInit:E,"script-src":"/public/admin/tinymce/tinymce.min.js"},null,8,["modelValue","setting"])]),_:1})):V("",!0),e.type==2?(m(),p(s,{key:1,label:"碎片内容"},{default:l(()=>[a(i,{type:"textarea",prop:"textarea",class:"textarea",rows:3,modelValue:e.content,"onUpdate:modelValue":t[4]||(t[4]=r=>e.content=r)},null,8,["modelValue"])]),_:1})):V("",!0)]),a(s,null,{default:l(()=>[a(I,{type:"primary",onClick:B},{default:l(()=>t[7]||(t[7]=[d("保存")])),_:1})]),_:1})]),_:1},8,["model","rules"])),[[N,n.value]])])}}},Ve=$(Q,[["__scopeId","data-v-db2a3f68"]]);export{Ve as default};
